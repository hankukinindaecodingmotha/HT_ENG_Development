<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <title>Login Page</title>
    <link rel="stylesheet" href="HT-eng-LoginStyle.css" />
    <link rel="stylesheet" href="../Components/Header/HT_eng-header.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <!-- 헤더 고정 높이 보정: header.css의 body padding-top:0을 덮어씀 -->
    <style>
        body {
            padding-top: 100px;
        }
    </style>
</head>

<body>
    <!-- 상단 바 컴포넌트 주입 컨테이너 -->
    <div id="header-container"></div>

  <div class="login-container">
    <h1>HTeng</h1>
    <p>에 오신 걸 환영합니다.</p>
    <input type="text" id="username" class="login-input" placeholder="ID" />
    <input type="password" id="password" class="login-input" placeholder="Password" />
    <div class="login-actions">
      <span id="signinBtn">sign in</span>
      <div class="divider"></div>
      <span id="signupBtn" style="opacity:.5; pointer-events:none;">sign up</span>
      <div class="divider"></div>
      <span id="helpBtn">Problem</span>
    </div>
  </div>

  <script>
    // 간단 로그인 처리: 서버 JWT 발급 → localStorage 저장 → 관리자 페이지로 이동
    document.getElementById('signinBtn').addEventListener('click', async () => {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      if (!username || !password) { alert('ID와 비밀번호를 입력하세요.'); return; }
      try {
        const res = await fetch('http://localhost:3000/api/auth/login', {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });
        if (!res.ok) {
          const e = await res.json().catch(()=>({message:'로그인 실패'}));
          alert(e.message || '로그인 실패');
          return;
        }
        const data = await res.json();
        localStorage.setItem('auth_token', data.token);
        localStorage.setItem('auth_user', data.username);
        localStorage.setItem('auth_role', data.role);
        window.location.href = '../Admin/HT_eng-Admin.html';
      } catch (err) {
        console.error(err); alert('서버와 통신할 수 없습니다.');
      }
    });
  </script>

    <!-- 헤더 로더 스크립트 -->
    <script defer src="../Components/Header/HT_eng-header.js"></script>
</body>

</html>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회사 구성원 - HT ENG</title>
    <link rel="stylesheet" href="HT_eng-members.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- 헤더 -->
    <div id="header-container"></div>

    <!-- 메인 콘텐츠 -->
    <main class="members-page">
        <div class="container">
            <div class="page-header">
                <h1 id="pageTitle">직원 소개</h1>
                <p id="pageSubtitle">전문성과 열정으로 고객의 성공을 만들어갑니다</p>
            </div>

            <div id="employeeList" class="employee-list">
                <div class="loading-message">
                    <i class="fas fa-spinner fa-spin"></i> 구성원 정보를 불러오는 중...
                </div>
            </div>
        </div>
    </main>

    <!-- 푸터 -->
    <div id="footer-container"></div>

    <script src="../Components/Header/HT_eng-header.js"></script>
    <script>
        // 구성원 정보 로드
        async function loadMembersInfo() {
            try {
                console.log('구성원 정보 로드 시작...');
                const response = await fetch('http://localhost:3000/api/intro-pages');
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('받은 데이터:', data);
                    
                    if (data.members) {
                        const membersInfo = data.members;
                        console.log('구성원 정보:', membersInfo);
                        
                        // 페이지 제목과 부제목 업데이트
                        const pageTitle = document.getElementById('pageTitle');
                        const pageSubtitle = document.getElementById('pageSubtitle');
                        
                        if (pageTitle) pageTitle.textContent = membersInfo.title || '직원 소개';
                        if (pageSubtitle) pageSubtitle.textContent = membersInfo.subtitle || '전문성과 열정으로 고객의 성공을 만들어갑니다';
                        
                        // 구성원 목록 렌더링
                        renderMembersList(membersInfo.members || []);
                    } else {
                        console.error('구성원 정보가 없습니다.');
                        showErrorMessage('구성원 정보를 불러올 수 없습니다.');
                    }
                } else {
                    console.error('구성원 정보 로드 실패:', response.status);
                    showErrorMessage('구성원 정보를 불러오는데 실패했습니다.');
                }
            } catch (error) {
                console.error('구성원 정보 로드 실패:', error);
                showErrorMessage('구성원 정보를 불러오는 중 오류가 발생했습니다.');
            }
        }

        // 구성원 목록 렌더링
        function renderMembersList(members) {
            const employeeList = document.getElementById('employeeList');
            
            if (!employeeList) return;
            
            if (!members || members.length === 0) {
                employeeList.innerHTML = `
                    <div class="no-members-message">
                        <i class="fas fa-users"></i>
                        <p>등록된 구성원이 없습니다.</p>
                    </div>
                `;
                return;
            }
            
            const membersHTML = members.map((member, index) => `
                <div class="employee-card">
                    <div class="employee-image">
                        <img src="../Assesets/Image/${member.image || 'CEO.jpeg'}" alt="${member.name}" class="member-img">
                    </div>
                    <div class="employee-info">
                        <h3 class="employee-name">${member.name}</h3>
                        <p class="employee-position">${member.position}</p>
                        <p class="employee-department">${member.department}</p>
                        ${member.experience ? `<p class="employee-experience">경력: ${member.experience}</p>` : ''}
                        ${member.email ? `<p class="employee-email"><i class="fas fa-envelope"></i> ${member.email}</p>` : ''}
                        <p class="employee-description">${member.description}</p>
                    </div>
                </div>
            `).join('');
            
            employeeList.innerHTML = membersHTML;
        }

        // 에러 메시지 표시
        function showErrorMessage(message) {
            const employeeList = document.getElementById('employeeList');
            if (employeeList) {
                employeeList.innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>${message}</p>
                    </div>
                `;
            }
        }

        // 페이지 로드 시 구성원 정보 로드
        document.addEventListener('DOMContentLoaded', function() {
            loadMembersInfo();
        });
    </script>
</body>
</html>